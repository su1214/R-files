---
title: "FINAL 2017121179 Seunghwan Kim"
output:
  word_document: default
  html_notebook: default
---


## 1. 12장 연습문제 19
```{r}
library(readxl)
q1<-read_xlsx("강수량.xlsx")
q1<-unlist(q1, use.names=F)
mean(q1)
var(q1)
sd(q1)
```
a. 표본평균은 1.662333, 표본표준편차는 1.018578이다. 표본 수가 30이므로 귀무가설하에서 각 구간의 기대도수가 5가 되도록 각 구간의 확률이 5/30=1/6가 되도록 구간을 설정.

```{r, echo=FALSE}
matrix(c(qnorm(1/6), qnorm(2/6), qnorm(3/6), qnorm(4/6), qnorm(5/6),
         mean(q1)+sd(q1)*qnorm(1/6), mean(q1)+sd(q1)*qnorm(2/6), mean(q1)+sd(q1)*qnorm(3/6),
         mean(q1)+sd(q1)*qnorm(4/6), mean(q1)+sd(q1)*qnorm(5/6)), ncol=5, nrow=2, byrow=T,
         dimnames = list(c("Z값", "X값"), c("1/6", "2/6", "3/6", "4/6", "5/6")))
```

값들을 구간에 맞게 표에 정리하면 다음과 같다.

```{r}
library(expss)
matrix(c("~0.6769390", "0.6769390~1.2236040", "1.2236040~1.662333", "1.662333~2.1010627",
         "2.1010627~2.6477277", "2.6477277~", 
         count_if(lt(0.6769390), q1), count_if(ge(0.6769390) & lt(1.2236040), q1), 
         count_if(ge(1.2236040) & lt(1.662333), q1), count_if(ge(1.662333) & lt(2.1010627), q1), 
         count_if(ge(2.1010627) & lt(2.6477277), q1), count_if(ge(2.6477277), q1),
         5,5,5,5,5,5,
         (4-5)^2/5, (7-5)^2/5, (7-5)^2/5, (4-5)^2/5, (3-5)^2/5, (5-5)^2/5),
         ncol=4, nrow= 6, byrow=F, dimnames=list(NULL, c("구간", "관측도수", "기대도수", "(Oi-Ei)^2/Ei")))
```

H~0~: 위 분포는 정규분포를 따른다.
H~1~: 그렇지 않다.
chi-squared 값과 p-value는 다음과 같고, p-value가 유의수준 0.05 혹은 0.01보다 크므로 귀무가설을 기각할 수 없다. 따라서 위 분포는 정규분포를 따른다고 말할 수 있다.
```{r}
(4-5)^2/5+(7-5)^2/5+(7-5)^2/5+(4-5)^2/5+(3-5)^2/5+(5-5)^2/5 #chi-squared value
pchisq(2.8, df=6-2-1, lower.tail = F) #p-value
```

--

```{r}
q1_1<-sqrt(q1)
mean(q1_1)
var(q1_1)
sd(q1_1)
```

b. 표본평균은 1.231434, 표본표준편차는 0.3885018이다. 표본 수가 30이므로 귀무가설하에서 각 구간의 기대도수가 5가 되도록 각 구간의 확률이 5/30=1/6가 되도록 구간을 설정.

```{r, echo=FALSE}
matrix(c(qnorm(1/6), qnorm(2/6), qnorm(3/6), qnorm(4/6), qnorm(5/6),
         mean(q1_1)+sd(q1_1)*qnorm(1/6), mean(q1_1)+sd(q1_1)*qnorm(2/6),
         mean(q1_1)+sd(q1_1)*qnorm(3/6), mean(q1_1)+sd(q1_1)*qnorm(4/6),
         mean(q1_1)+sd(q1_1)*qnorm(5/6)), ncol=5, nrow=2, byrow=T,
         dimnames = list(c("Z값", "X값"), c("1/6", "2/6", "3/6", "4/6", "5/6")))
```

값들을 구간에 맞게 표에 정리하면 다음과 같다.

```{r}
library(expss)
matrix(c("~0.8555894", "0.8555894~1.0640961", "1.0640961~1.231434", "1.231434~1.3987728",
         "1.3987728~1.6072795", "1.6072795~", 
         count_if(lt(0.8555894), q1_1), count_if(ge(0.8555894) & lt(1.0640961), q1_1), 
         count_if(ge(1.0640961) & lt(1.231434), q1_1),
         count_if(ge(1.231434) & lt(1.3987728), q1_1), 
         count_if(ge(1.3987728) & lt(1.6072795), q1_1), count_if(ge(1.6072795), q1_1),
         5,5,5,5,5,5,
         (4-5)^2/5, (7-5)^2/5, (5-5)^2/5, (5-5)^2/5, (4-5)^2/5, (5-5)^2/5),
         ncol=4, nrow= 6, byrow=F, dimnames=list(NULL, c("구간", "관측도수", "기대도수", "(Oi-Ei)^2/Ei")))
```

H~0~: 위 분포는 정규분포를 따른다.
H~1~: 그렇지 않다.
chi-squared 값과 p-value는 다음과 같고, p-value가 유의수준 0.05 혹은 0.01보다 크므로 귀무가설을 기각할 수 없다. 따라서 위 분포는 정규분포를 따른다고 말할 수 있다.
```{r}
(4-5)^2/5+(7-5)^2/5+(5-5)^2/5+(5-5)^2/5+(4-5)^2/5+(5-5)^2/5 #chi-squared value
pchisq(1.2, df=6-2-1, lower.tail = F) #p-value
```


## 2. 12장 연습문제 22
```{r}
library(readxl)
q2<-read_xlsx("찬성분포.xlsx",col_types = c("skip", "numeric", "numeric"))
dimnames(q2)<-list(c("경기", "서울", "강원", "영남", "호남"), c("찬성", "반대"))
q2<-cbind(q2, rowSums(q2))
q2<-rbind(q2, colSums(q2))
q2_expected<-matrix(c((q2[1,3]/630)*(q2[6,1]/630)*630,
                      (q2[2,3]/630)*(q2[6,1]/630)*630,
                      (q2[3,3]/630)*(q2[6,1]/630)*630,
                      (q2[4,3]/630)*(q2[6,1]/630)*630,
                      (q2[5,3]/630)*(q2[6,1]/630)*630,
                      (q2[1,3]/630)*(q2[6,2]/630)*630,
                      (q2[2,3]/630)*(q2[6,2]/630)*630,
                      (q2[3,3]/630)*(q2[6,2]/630)*630,
                      (q2[4,3]/630)*(q2[6,2]/630)*630,
                      (q2[5,3]/630)*(q2[6,2]/630)*630), byrow=F, ncol=2, nrow=5)
q2_expected

sum((q2[1:5,1:2]-q2_expected)^2/q2_expected) #chi-squared
pchisq(sum((q2[1:5,1:2]-q2_expected)^2/q2_expected), df=4, lower.tail=F) #p-value
```
a. H~0~: 지역과 동의여부는 독립이다.
   H~1~: 그렇지 않다.
   
   chi-squared value: 0.260, p-value: 0.9922
   p-value가 보통의 유의수준인 0.05 혹은 0.01보다 매우 크므로 귀무가설을 기각할 수 없다. 지역과 동의 여부는 독립이라고 말할 수 있다.
   
```{r}
((120/225-334/630)^2/sqrt(120/225))+((143/275-334/630)^2/sqrt(143/275))+((24/44-334/630)^2/sqrt(24/44))+((22/40-334/630)^2/sqrt(22/40))+((25/45-334/630)^2/sqrt(25/45))
```
   
b. 주어진 통계량은 0.0019로, 앞의 chi-squared값보다 작은 값이 나왔다.

## 3. 13장 연습문제 17
```{r}
library(readxl)
q3<-read_xlsx("장난감.xlsx")
mean(q3[1:5,1]) #인터넷쇼핑몰 평균
var(unlist(q3)[1:5]) #인터넷쇼핑몰 표본분산
mean(q3[1:4,2]) #대형할인점 평균
var(unlist(q3)[7:10]) #대형할인점 표본분산
mean(q3[1:6,3]) #백화점 평균
var(unlist(q3)[13:18]) #백화점 표본분산
mean(na.omit(unlist(q3))) #전체 평균
var(na.omit(unlist(q3))) #전체 표본분산

q3_SSTR<-5*(mean(q3[1:5,1])-mean(na.omit(unlist(q3))))^2+
  4*(mean(q3[1:4,2])-mean(na.omit(unlist(q3))))^2+
  6*(mean(q3[1:6,3])-mean(na.omit(unlist(q3))))^2
q3_SSTR #SSTR

q3_MSTR<-q3_SSTR/2
q3_MSTR #MSTR

q3_SSE<-4*var(unlist(q3)[1:5])+3*var(unlist(q3)[7:10])+5*var(unlist(q3)[13:18])
q3_SSE #SSE

q3_MSE<-q3_SSE/(15-3)
q3_MSE #MSE

q3_MSTR/q3_MSE #F-statistic

pf(q3_MSTR/q3_MSE, df1=3, df2=15-3, lower.tail=FALSE) #p-value
```

H~0~: 각 판매처별로 평균 판매량은 동일하다. (μ~1~=μ~2~=μ~3~)
H~1~: not H1

F 통계량은 19.75469이고, p-value는 0.05보다 작으며 0애 매우 가까워 귀무가설을 기각한다. 장난감의 판매처에 따라 그 장난감은 유의적으로 다른 가격에 판매되고 있다.

다중비교
```{r}
qtukey(0.95, 3, 15-3) #tukey 값

c(mean(q3[1:5,1])-mean(q3[1:4,2])-(qtukey(0.95, 3, 15-3)/sqrt(2))*sqrt(q3_MSE*(1/5+1/4)),
  mean(q3[1:5,1])-mean(q3[1:4,2])+(qtukey(0.95, 3, 15-3)/sqrt(2))*sqrt(q3_MSE*(1/5+1/4))) #인터넷쇼핑몰, 대형할인점 Tukey신뢰구간

c(mean(q3[1:4,2])-mean(q3[1:6,3])-(qtukey(0.95, 3, 15-3)/sqrt(2))*sqrt(q3_MSE*(1/4+1/6)),
  mean(q3[1:4,2])-mean(q3[1:6,3])+(qtukey(0.95, 3, 15-3)/sqrt(2))*sqrt(q3_MSE*(1/4+1/6))) #대형할인점, 백화점 Tukey신뢰구간

c(mean(q3[1:5,1])-mean(q3[1:6,3])-(qtukey(0.95, 3, 15-3)/sqrt(2))*sqrt(q3_MSE*(1/5+1/6)),
  mean(q3[1:5,1])-mean(q3[1:6,3])+(qtukey(0.95, 3, 15-3)/sqrt(2))*sqrt(q3_MSE*(1/5+1/6))) #인터넷쇼핑몰, 백화점 Tukey신뢰구간

```

Tukey 다중비교 결과, 0.95 신뢰수준에서 인터넷 쇼핑몰과 대형할인점 간에는 그 장난감이 유의적으로 다른 가격에 판매되고 있지 않지만, 인터넷쇼핑몰과 백화점 간, 대형할인점과 백화점 간에는 유의적으로 다른 가격에 판매되고 있음을 확인할 수 있다.

## 4. 13장 연습문제 29
```{r}
library(readxl)
q4<-read_xlsx("TV광고.xlsx")
q4_values<-unlist(q4,use.names=F)[10:27]
q4_time.fac <- as.factor(c(11,11,11,3,3,3,8,8,8,11,11,11,3,3,3,8,8,8))
q4_preorpost.fac <- as.factor(c(rep("before",9),rep("after", 9)))
q4.df<-data.frame(q4_time.fac, q4_preorpost.fac, q4_values)
interaction.plot(q4_time.fac, q4_preorpost.fac, q4_values, type="l", main="interaction effect plot", ylim=c(0,120))

mean(q4[1:9,2]) #프로그램시작전 평균
var(unlist(q4[1:9,2])) #프로그램시작전 분산
mean(q4[1:9,3]) #프로그램종료후 평균
var(unlist(q4[1:9,3])) #프로그램종료후 분산

mean(q4[1:3,2:3]) #오전 11시대 평균
var(unlist(q4[1:3,2:3])) #오전 11시대 분산
mean(q4[4:6,2:3]) #오후 3시대 평균
var(unlist(q4[4:6,2:3])) #오후 3시대 분산
mean(q4[7:9,2:3]) #오후 8시대 평균
var(unlist(q4[7:9,2:3])) #오후 8시대 분산

mean(c(62,68,64)) #오전 11시대, 시작전 평균
var(c(62,68,64)) #오전 11시대, 시작전 분산
mean(c(51, 47, 48)) #오전 11시대, 종료후 평균
var(c(51, 47, 48)) #오전 11시대, 종료후 분산
mean(c(88, 85, 81)) #오후 3시대, 시작전 평균
var(c(88, 85, 81)) #오후 3시대, 시작전 분산
mean(c(67, 60, 66)) #오후 3시대, 종료후 평균
var(c(67, 60, 66)) #오후 3시대, 종료후 분산
mean(c(127,120,126)) #오후 8시대, 시작전 평균
var(c(127,120,126)) #오후 8시대, 시작전 분산
mean(c(105, 101, 107)) #오후 8시대, 종료후 평균
var(c(105, 101, 107)) #오후 8시대, 종료후 분산

mean(q4[1:9,2:3]) #전체 평균
var(unlist(q4[1:9,2:3])) #전체 분산

q4_SST<-sum((unlist(q4[1:9,2:3])-mean(q4[1:9,2:3]))^2)

q4_SSint<-3*((mean(c(62,68,64))-mean(q4[1:3,2:3])-mean(q4[1:9,2])+mean(q4[1:9,2:3]))^2+
             (mean(c(51, 47, 48))-mean(q4[1:3,2:3])-mean(q4[1:9,3])+mean(q4[1:9,2:3]))^2+
             (mean(c(88, 85, 81))-mean(q4[4:6,2:3])-mean(q4[1:9,2])+mean(q4[1:9,2:3]))^2+
             (mean(c(67, 60, 66))-mean(q4[4:6,2:3])-mean(q4[1:9,3])+mean(q4[1:9,2:3]))^2+
             (mean(c(127,120,126))-mean(q4[7:9,2:3])-mean(q4[1:9,2])+mean(q4[1:9,2:3]))^2+
             (mean(c(105, 101, 107))-mean(q4[7:9,2:3])-mean(q4[1:9,3])+mean(q4[1:9,2:3]))^2)
q4_MSint<-q4_SSint/2

q4_SSTR1<-2*3*((mean(q4[1:3,2:3])-mean(q4[1:9,2:3]))^2+
               (mean(q4[4:6,2:3])-mean(q4[1:9,2:3]))^2+
               (mean(q4[7:9,2:3])-mean(q4[1:9,2:3]))^2)
q4_MSTR1<-q4_SSTR1/2

q4_SSTR2<-3*3*((mean(q4[1:9,2])-mean(q4[1:9,2:3]))^2+
               (mean(q4[1:9,3])-mean(q4[1:9,2:3]))^2)
q4_MSTR2<-q4_SSTR2/1

q4_SSE<-q4_SST-q4_SSint-q4_SSTR1-q4_SSTR2
q4_MSE<-q4_SSE/12
```

b. H~0~: 방영시간대와 방영기점 사이에 상호작용은 없다.
   H~1~: 방영시간대와 방영기점 사이에 상호작용은 있다.
   
```{r}
q4_MSint/q4_MSE #F-statistic
pf(q4_MSint/q4_MSE, df1=2, df2=12, lower.tail=F) #p-value
```
   p-value가 0.465로 5%보다 크므로 귀무가설을 기각할 수 없다. 따라서 상호작용은 없다고 말할 수 있다.
   
c. H~0~: 방영시간대별로 광고의 효과에 차이는 없다.
   H~1~: 방영시간대별로 광고의 효과에 차이는 있다.
   
```{r}
q4_MSTR1/q4_MSE #F-statistic
pf(q4_MSTR1/q4_MSE, df1=2, df2=12, lower.tail=F) #p-value
```
   p-value가 3.121003e-12로 5%보다 작아 귀무가설을 기각한다. 따라서 방영시간대별로 광고의 효과에 차이는 있다고 말할 수 있다.
   
d. H~0~: 방영기점별로 광고의 효과에 차이는 없다.
   H~1~: 방영기점별로 광고의 효과에 차이는 있다.
   
```{r}
q4_MSTR2/q4_MSE #F-statistic
pf(q4_MSTR2/q4_MSE, df1=1, df2=12, lower.tail=F) #p-value
```
   p-value가 4.034439e-08로 5%보다 작아 귀무가설을 기각한다. 따라서 방영기점별로 광고의 효과에 차이는 있다고 말할 수 있다.

e. 광고의 효과를 극대화하기 위해서는 평균값이 가장 높게 나타난 오후 8시대 프로그램 시작 전에 하는 것이 가장 유리하다. 시간대별로, 기점별로 모두 통계적으로 유의적이기 때문에.

## 5. 14장 연습문제 21
```{r}
library(readxl)
q5<-read_xlsx("mean.xlsx")
```

a. 

```{r}
q5[1,1]<-c(16.5)
q5[2,1]<-17.5
q5[3,1]<-18.5
q5[4,1]<-19.5
q5[5,1]<-20.5
q5[6,1]<-21.5
q5[7,1]<-22.5
q5[8,1]<-23.5
q5[9,1]<-24.5
q5[10,1]<-25.5
q5<-as.data.frame(apply(q5, 2, as.numeric))
```

b. 
```{r}
plot(mo_3~Temp,q5)
```
온도가 매우 높을 때를 빼고는 비슷한 수준의 사망률이 나타나고 있다.

```{r}
plot(mo_3_12~Temp,q5)
```
온도가 높아짐에 따라 사망률이 내렸다 올랐다 한다.

c. 모르겠다.

d. 회귀식에서 값들이 많이 떨어져 있으며 그 정도도 불규칙하다.
```{r}
plot(mo_3~Temp,q5)
abline(lm(mo_3~Temp+Temp^2,q5))
```

```{r}
q5_1<-data.frame(matrix(c(0, 19.7, 0, 20.9, 0, 19.1, 0, 19.8, 1, 20.4, 1, 22.9, 0, 21.5, 2, 20.0, 0, 19.4, 1, 21.5, 1, 21.1, 1, 19.9, 1, 21.9, 0, 19.7, 0, 20.1, 0, 20.5, 0, 20.5, 2, 19.5, 1, 20.6, 1, 21.1, 0, 19.1, 1, 19.4, 2, 19.0, 4, 19.0, 0, 19.6, 0, 20.7, 1, 19.6, 0, 21.4, 0, 22.4, 1, 19.1), nrow=30, ncol=2, byrow=T, dimnames=list(NULL, c("SIDSdeaths", "Temp"))))
```

e. 
```{r}
plot(SIDSdeaths~Temp, q5_1)
```

f. b 패턴과 비교했을 때, 비교적 Y값의 변화가 두드러지게 보이며 낮은 온도에서 사망이 많이 발생하는 것으로 보인다. 완전한 선형 관계는 아니지만, 어느 정도의 영향이 있어보인다.
```{r}
plot(SIDSdeaths~jitter(Temp, 1), q5_1)
```

g. 온도를 SIDS에 영향을 주는 요인으로 의심할 만하다. 오차가 크긴 하지만 비교적 회귀선 주위에 데이터가 분포하고 있는 것처럼 보인다.
```{r}
plot(SIDSdeaths~Temp, q5_1)
abline(lm(SIDSdeaths~Temp+Temp^2, q5_1))
```

h. 먼저, b에서의 데이터는 Temp값 하나에 사망률 자료가 있어서 자료가 부족하다. 범위가 아닌 실제 온도를 자료에 포함한 g의 경우가 그런 면에서 더 정확하다고 볼 수 있다. 

## 6. 16장 익힘문제 4, 5, 8, 13, 24, 29, 34, 59, 60

### 4번
회귀분석에서는 변수변환을 통하여 모형구축을 {쉽게} 할 수 있고, 결과의 해석이 {쉽고} 또한 변수변환하여 추정된 모형의 (적합성)이 우수하여 예측의 (정확성)을 높일 수 있다.

### 5번
변수변환은 기본적으로 비선형관계에 있는 설명변수와 반응변수를 (선형)관계로 변화시키기 위하여 행해진다. (선형)모형이 비선형모형에 비하여 훨씬 다루기 쉽기 때문이다.

### 8번
변수변환은 변수에 멱승을 하여 이루어지게 된다. 멱승을 순서대로 나열하면 ~. 멱의 크기가 클수록 함수의 변화속도가 {많다}. (X^1^)변환은 아무 변환도 하지 않는 것이고, (X^0^)변환은 모든 자료를 1로 만들어버리므로 변수의 변환에 사용할 수 없다. 함수의 변화 속도를 고려할 때 (X^0^)의 위치에 있는 것이 (로그)함수이다.

### 13번
회귀모형에서 변수를 모형에 추가하거나 모형에 있는 변수를 제거하거나 또는 고려 대상이 되는 두 모형을 서로 비교하여 최적의 모형을 구축하려는 (모형비교)을 하게 된다.

### 24번
우도함수의 값은 클수록 {높은} 적합성 또는 정확성을 나타내고 있어, 적합이 잘 될수록 AIC는 {작아}진다. k는 매개변수의 수이므로 매개변수가 많은 것은 뫃형이 {복잡}하므로 {복잡성}을 나타낸다고 할 수 있다. k는 (간결원칙)원칙의 입장에서는 {작을}수록 좋다.

### 29번
가변수 모형에서는 0과 1을 그대로 사용하지만, 로지스틱모형에서는 0또는 1이 될 (확률)을 ㅣ용하여 Y변수를 만들게 된다. 즉, Y는 P=Pr(Y=1)을 모수로 갖는 (베르누이)시행이다.

### 34번
f(x)=exp(β~0~+β~1~x)/(1+exp(β~0~+β~1~x))에서 f(x)의 값은 (0)과 (1)사이이다. β~0~의 값은 로지스틱함수의 (좌우 위치)를 결정하고 β~1~의 값은 (기울)기를 결정한다. β~0~와 β~1~은 (-∞)에서 (+∞)사이의 모든 값을 가질 수 있다. β~0~가 작으면 {왼쪽}에 위치한다. β~1~의 값이 크면 기울기가 {가파르다}.

### 59번
단계적선택법의 각 단계에는 두 개의 하위단계가 존재하는데, 첫 번째 하위단계에서는 (전진선택법)을 실시하고, 두 번째 하위단계에서는 전 단계인 (전진선택법)에 의하여 {선택}된 회귀모형에 대하여 (후진제거법)을 실시하게 된다.

### 60번
단계적선택법에서는 각 단계마다 (전진선택법)과 (후진제거법)을 실시하면서 다음 단계로 넘어가게 되는데, 이러한 각 단계를 반복적으로 실시하여 더 이상 회귀모형에 변화가 {없으면} 중단하게 된다.

## 7. 17장 연습문제 4

H~0~: M=4천만원
H~1~: M≠4천만원

표본이 충분히 크므로 정규분포에 근사하여 p값을 구하는 것이 편리하다. 평균은 205·0.5, 분산은 205·0.5·0.5가 된다.
Pr(X>=175)=Pr(X>=175-0.5)=Pr(Z>=(175-0.5-205·0.5)/sqrt(205·0.5·0.5)
```{r}
2*pnorm((175-0.5-205*0.5)/sqrt(205*0.5*0.5), lower.tail = F) #p-value
```

p-value가 8.522245e-24으로 매우 작으며 0.05보다는 당연히 작으므로 귀무가설을 기각한다. 따라서 유의수준 5%에서 5년 경력의 컴퓨터 프로그래머들의 중앙값 연봉이 4천만원이라고 말할 수 없다.


